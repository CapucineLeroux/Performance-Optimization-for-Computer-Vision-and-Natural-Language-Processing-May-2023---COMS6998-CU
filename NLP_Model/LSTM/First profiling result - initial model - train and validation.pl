First profiling result - initial model - validation and training


Time:
===============
Overall Time: 1m 0s
	Train Time: 0m 58s
	Validation Time: 0m 2s
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                  train        38.88%       37.428s        60.72%       58.449s       58.449s       0.000us         0.00%       32.985s       32.985s       1.51 Mb    -136.51 Mb     864.94 Mb    -358.75 Gb             1  
                                               aten::to         0.03%      32.954ms         0.32%     312.429ms      17.932us       0.000us         0.00%      88.454ms       5.077us     317.66 Kb      -9.15 Kb     285.34 Mb     596.00 Kb         17423  
                                         aten::_to_copy         0.05%      43.374ms         0.30%     286.134ms      29.556us       0.000us         0.00%      88.782ms       9.171us     331.27 Kb      10.24 Kb     285.34 Mb           0 b          9681  
                                    aten::empty_strided         0.11%     104.006ms         0.11%     104.006ms       4.235us       0.000us         0.00%       0.000us       0.000us     299.18 Kb     299.18 Kb     142.51 Gb     142.51 Gb         24558  
                                            aten::copy_         0.10%      92.649ms         0.46%     442.363ms      27.722us     529.469ms         0.65%     710.913ms      44.552us      21.29 Kb     -53.59 Kb           0 b           0 b         15957  
                                        cudaMemcpyAsync        13.56%       13.058s        13.56%       13.058s     156.646us        1.035s         1.28%        1.035s      12.417us           0 b           0 b           0 b           0 b         83357  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      45.734ms         0.06%      45.734ms      24.964us           0 b           0 b           0 b           0 b          1832  
                                  cudaStreamSynchronize        25.78%       24.816s        25.78%       24.816s     301.916us     847.447ms         1.05%     847.447ms      10.310us           0 b           0 b           0 b           0 b         82194  
                aten::_has_compatible_shallow_copy_type         0.00%       2.000us         0.00%       2.000us       0.091us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            22  
                    aten::_use_cudnn_rnn_flatten_weight         0.00%       2.000us         0.00%       2.000us       2.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             1  
                        aten::_cudnn_rnn_flatten_weight         0.00%       1.124ms         0.00%       1.562ms       1.562ms       0.000us         0.00%      90.000us      90.000us           0 b           0 b           0 b     -16.00 Kb             1  
                                  cudaStreamIsCapturing         0.00%       2.937ms         0.00%       2.937ms       0.862us       2.505ms         0.00%       2.505ms       0.735us           0 b           0 b           0 b           0 b          3407  
                                  cudaStreamGetPriority         0.00%     612.000us         0.00%     612.000us       0.265us       2.048ms         0.00%       2.048ms       0.886us           0 b           0 b           0 b           0 b          2311  
                       cudaDeviceGetStreamPriorityRange         0.00%     306.000us         0.00%     306.000us       0.132us     919.000us         0.00%     919.000us       0.398us           0 b           0 b           0 b           0 b          2311  
                                            aten::zeros         0.02%      22.836ms         0.17%     161.094ms      35.775us       0.000us         0.00%     269.867ms      59.930us           0 b           0 b     140.01 Gb           0 b          4503  
                                            aten::empty         0.16%     158.658ms         0.16%     158.658ms       5.637us       0.000us         0.00%       0.000us       0.000us       1.80 Mb       1.80 Mb    1280.12 Gb    1280.12 Gb         28148  
                                            aten::zero_         0.02%      20.992ms         0.13%     121.925ms      21.691us       0.000us         0.00%     282.875ms      50.325us           0 b           0 b           0 b           0 b          5621  
                                            aten::fill_         0.05%      47.087ms         0.12%     110.952ms      16.374us     184.069ms         0.23%     284.678ms      42.013us           0 b           0 b           0 b           0 b          6776  
                                       cudaLaunchKernel         8.39%        8.080s         8.39%        8.080s       4.284us       19.587s        24.20%       19.984s      10.595us           0 b           0 b           0 b           0 b       1886106  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     184.072ms         0.23%     184.072ms      29.838us           0 b           0 b           0 b           0 b          6169  
                                             aten::set_         0.01%      12.925ms         0.01%      12.925ms       2.577us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     -14.02 Mb     -14.02 Mb          5015  
                                          aten::view_as         0.00%      29.000us         0.00%      33.000us       2.062us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            16  
                                             aten::view         0.01%       5.112ms         0.01%       5.112ms       1.494us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          3422  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      98.781ms         0.12%      98.781ms      57.733us           0 b           0 b           0 b           0 b          1711  
                                          aten::random_         0.00%      55.000us         0.00%      55.000us       9.167us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             6  
                                             aten::item         0.16%     153.290ms        13.90%       13.378s     146.488us       0.000us         0.00%        1.777s      19.462us           0 b           0 b           0 b           0 b         91324  
                              aten::_local_scalar_dense         0.31%     302.870ms        13.80%       13.285s     145.476us      79.606ms         0.10%        1.820s      19.933us           0 b           0 b           0 b           0 b         91324  
enumerate(DataLoader)#_SingleProcessDataLoaderIter._...         0.58%     554.112ms         1.14%        1.098s       1.800ms       0.000us         0.00%       0.000us       0.000us     151.96 Mb      -1.18 Mb           0 b           0 b           610  
                                         aten::randperm         0.00%       3.580ms         0.01%       7.231ms     602.583us       0.000us         0.00%       0.000us       0.000us       1.18 Mb         -48 b           0 b           0 b            12  
                                    aten::scalar_tensor         0.00%      24.000us         0.00%      24.000us       4.000us       0.000us         0.00%       0.000us       0.000us          48 b          48 b           0 b           0 b             6  
                                          aten::resize_         0.01%      12.533ms         0.01%      12.533ms       2.035us       0.000us         0.00%       0.000us       0.000us           0 b           0 b      19.05 Gb      19.05 Gb          6158  
                                     aten::resolve_conj         0.00%       1.000us         0.00%       1.000us       0.167us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             6  
                                      aten::resolve_neg         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             6  
                                           aten::select         0.39%     374.436ms         0.40%     383.826ms       1.579us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        243089  
                                       aten::as_strided         0.02%      21.548ms         0.02%      21.548ms       0.063us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b        342787  
                                            aten::stack         0.15%     142.448ms         0.34%     324.806ms     184.339us       0.000us         0.00%       3.402ms       1.931us     151.96 Mb           0 b     274.00 Kb           0 b          1762  
                                              aten::cat         0.15%     142.005ms         0.16%     156.959ms      89.080us       3.291ms         0.00%       3.402ms       1.931us     151.96 Mb     151.96 Mb     274.00 Kb     274.00 Kb          1762  
                                           aten::narrow         0.00%       4.281ms         0.01%       7.962ms       6.558us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1214  
                                            aten::slice         0.02%      15.432ms         0.02%      16.892ms       4.793us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          3524  
                                        aten::unsqueeze         0.03%      25.688ms         0.03%      27.666ms       0.329us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b         84076  
                     Optimizer.zero_grad#Adam.zero_grad         0.03%      32.310ms         0.03%      32.310ms      58.960us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     -70.77 Gb     -70.77 Gb           548  
                                        aten::embedding         0.01%      12.937ms         0.06%      59.961ms      98.783us       0.000us         0.00%      66.089ms     108.878us           0 b           0 b      18.92 Gb           0 b           607  
                                          aten::reshape         0.01%       4.879ms         0.01%       5.822ms       9.591us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           607  
                                   aten::_reshape_alias         0.00%     955.000us         0.00%     955.000us       1.573us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           607  
                                     aten::index_select         0.02%      16.988ms         0.04%      40.153ms      66.150us      65.976ms         0.08%      66.089ms     108.878us           0 b           0 b      18.92 Gb           0 b           607  
void at::native::(anonymous namespace)::indexSelectL...         0.00%       0.000us         0.00%       0.000us       0.000us      65.976ms         0.08%      65.976ms     108.692us           0 b           0 b           0 b           0 b           607  
                                             aten::lstm         0.05%      51.994ms         5.29%        5.095s       8.393ms       0.000us         0.00%       29.859s      49.192ms           0 b           0 b     415.48 Gb           0 b           607  
                              aten::cudnn_is_acceptable         0.00%       2.178ms         0.00%       2.178ms       3.588us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           607  
                               cudaStreamGetCaptureInfo         0.00%       2.467ms         0.00%       2.467ms       2.032us     757.000us         0.00%     757.000us       0.624us           0 b           0 b           0 b           0 b          1214  
                                    cudaStreamWaitEvent         0.05%      52.537ms         0.05%      52.537ms       0.111us        5.329s         6.58%        5.329s      11.224us           0 b           0 b           0 b           0 b        474801  
                                       aten::_cudnn_rnn         2.43%        2.342s         5.22%        5.025s       8.278ms       22.880s        28.27%       29.857s      49.188ms           0 b           0 b     415.48 Gb    -224.99 Gb           607  
                                        aten::transpose         0.01%       9.743ms         0.02%      16.293ms       2.651us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          6146  
                                       aten::contiguous         0.01%      11.377ms         0.11%     110.491ms      39.475us       0.000us         0.00%     255.745ms      91.370us           0 b           0 b     104.37 Gb      10.88 Gb          2799  
                                            aten::clone         0.01%      12.785ms         0.11%     105.657ms      37.748us       0.000us         0.00%     274.954ms      98.233us           0 b           0 b     104.37 Gb      -2.56 Gb          2799  
                                       aten::empty_like         0.02%      20.489ms         0.08%      72.654ms       7.636us       0.000us         0.00%       0.000us       0.000us      75.31 Kb      16.07 Kb     105.86 Gb       2.60 Gb          9515  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     289.539ms         0.36%     289.539ms      73.227us           0 b           0 b           0 b           0 b          3954  
          cudaOccupancyMaxActiveBlocksPerMultiprocessor         0.02%      22.263ms         0.02%      22.263ms       0.062us        4.348s         5.37%        4.348s      12.180us           0 b           0 b           0 b           0 b        356944  
                                  volta_sgemm_128x64_tn         0.00%       0.000us         0.00%       0.000us       0.000us        5.121s         6.33%        5.121s     527.253us           0 b           0 b           0 b           0 b          9712  
                        volta_sgemm_128x32_sliced1x4_tn         0.00%       0.000us         0.00%       0.000us       0.000us       12.350s        15.26%       12.350s      39.936us           0 b           0 b           0 b           0 b        309248  
void elemWiseRNNcell<float, float, float, (cudnnRNNM...         0.00%       0.000us         0.00%       0.000us       0.000us        5.139s         6.35%        5.139s      16.534us           0 b           0 b           0 b           0 b        310784  
void cudnn::dropout_generate_mask<4>(float, curandSt...         0.00%       0.000us         0.00%       0.000us       0.000us      74.946ms         0.09%      74.946ms     136.763us           0 b           0 b           0 b           0 b           548  
void cudnn::dropout_apply_mask<float, float, 4>(floa...         0.00%       0.000us         0.00%       0.000us       0.000us        1.379s         1.70%        1.379s      18.400us           0 b           0 b           0 b           0 b         74948  
                                       aten::transpose_         0.01%       5.005ms         0.01%       9.789ms       8.475us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1155  
                                      aten::as_strided_         0.00%       4.784ms         0.00%       4.784ms       4.142us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1155  
                                          aten::dropout         0.00%       2.809ms         0.04%      39.373ms      64.865us       0.000us         0.00%       4.483ms       7.386us           0 b           0 b     170.90 Mb           0 b           607  
                                   aten::native_dropout         0.02%      16.458ms         0.04%      36.564ms      66.723us       3.360ms         0.00%       4.483ms       8.181us           0 b           0 b     170.90 Mb      -6.75 Mb           548  
                                           aten::linear         0.00%       4.011ms         0.07%      65.025ms     107.125us       0.000us         0.00%       6.301ms      10.381us           0 b           0 b     303.50 Kb       2.00 Kb           607  
                                                aten::t         0.01%      10.482ms         0.02%      18.636ms       6.658us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          2799  
                                            aten::addmm         0.04%      38.945ms         0.05%      52.759ms      86.918us       5.736ms         0.01%       6.340ms      10.445us           0 b           0 b     303.50 Kb     303.50 Kb           607  
                                           aten::expand         0.01%       5.375ms         0.01%       6.722ms       3.815us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1762  
                                          aten::sigmoid         0.01%      13.833ms         0.02%      20.307ms      33.455us       2.371ms         0.00%       2.742ms       4.517us           0 b           0 b     303.50 Kb     303.50 Kb           607  
                                               aten::gt         0.02%      14.919ms         0.02%      20.742ms      34.171us       2.062ms         0.00%       2.264ms       3.730us           0 b           0 b     303.50 Kb     303.50 Kb           607  
                                           aten::unbind         0.10%      94.612ms         0.20%     193.154ms     318.211us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           607  
                                               aten::eq         0.94%     902.840ms         1.49%        1.433s      18.341us     165.782ms         0.20%     927.220ms      11.871us           0 b           0 b      38.14 Mb      38.14 Mb         78107  
                                       aten::is_nonzero         0.25%     238.672ms        13.92%       13.396s     172.852us       0.000us         0.00%        1.561s      20.136us           0 b           0 b           0 b           0 b         77500  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us       3.360ms         0.00%       3.360ms       6.131us           0 b           0 b           0 b           0 b           548  
void gemv2T_kernel_val<int, int, float, float, float...         0.00%       0.000us         0.00%       0.000us       0.000us       3.530ms         0.00%       3.530ms       5.844us           0 b           0 b           0 b           0 b           604  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.371ms         0.00%       2.371ms       3.906us           0 b           0 b           0 b           0 b           607  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.062ms         0.00%       2.062ms       3.397us           0 b           0 b           0 b           0 b           607  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      41.263ms         0.05%      41.263ms       2.130us           0 b           0 b           0 b           0 b         19375  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us     175.617ms         0.22%     175.617ms       2.200us           0 b           0 b           0 b           0 b         79814  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      81.235ms         0.10%      81.235ms       2.096us           0 b           0 b           0 b           0 b         38750  
void at::native::vectorized_elementwise_kernel<2, at...         0.00%       0.000us         0.00%       0.000us       0.000us      41.192ms         0.05%      41.192ms       2.126us           0 b           0 b           0 b           0 b         19375  
                                       aten::lift_fresh         0.00%      23.000us         0.00%      23.000us       0.037us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           618  
                                          aten::detach_         0.00%       1.414ms         0.00%       2.059ms       3.332us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           618  
                                                detach_         0.00%     714.000us         0.00%     714.000us       1.155us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           618  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.105ms         0.00%       2.105ms       3.468us           0 b           0 b           0 b           0 b           607  
                                        aten::expand_as         0.00%       2.856ms         0.01%       7.578ms       6.561us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1155  
                                             aten::mean         0.02%      23.832ms         0.05%      48.693ms      37.601us       3.868ms         0.00%       4.244ms       3.277us       2.91 Kb         748 b     313.50 Kb     313.50 Kb          1295  
                                              aten::sum         0.02%      18.568ms         0.03%      24.492ms      21.205us       3.342ms         0.00%       3.368ms       2.916us           0 b           0 b     274.00 Kb     274.00 Kb          1155  
                                             aten::div_         0.02%      17.954ms         0.03%      27.548ms      23.830us       1.645ms         0.00%       1.683ms       1.456us       3.18 Kb         736 b           0 b           0 b          1156  
                                          aten::squeeze         0.01%       7.529ms         0.01%       7.689ms       3.167us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          2428  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us       2.394ms         0.00%       2.394ms       3.944us           0 b           0 b           0 b           0 b           607  
                             aten::binary_cross_entropy         0.02%      19.423ms         0.07%      68.153ms     112.278us       2.922ms         0.00%       9.106ms      15.002us           0 b           0 b     303.50 Kb    -326.00 Kb           607  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       2.922ms         0.00%       2.922ms       4.814us           0 b           0 b           0 b           0 b           607  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       3.868ms         0.00%       3.868ms       6.372us           0 b           0 b           0 b           0 b           607  
                                       aten::resize_as_         0.00%       4.587ms         0.01%       9.245ms       1.852us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          4991  
                                        aten::ones_like         0.00%       2.162ms         0.02%      15.910ms      29.033us       0.000us         0.00%       1.764ms       3.219us           0 b           0 b     274.00 Kb      -5.50 Kb           548  
autograd::engine::evaluate_function: BinaryCrossEntr...         0.02%      17.560ms         0.08%      79.121ms     144.381us       0.000us         0.00%       3.917ms       7.148us           0 b           0 b           0 b    -274.50 Kb           548  
                            BinaryCrossEntropyBackward0         0.01%       5.230ms         0.06%      61.456ms     112.146us       0.000us         0.00%       3.905ms       7.126us           0 b           0 b     274.00 Kb         512 b           548  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 96.263s
Self CUDA time total: 80.938s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
enumerate(DataLoader)#_SingleProcessDataLoaderIter._...         0.58%     554.112ms         1.14%        1.098s       1.800ms       0.000us         0.00%       0.000us       0.000us     151.96 Mb      -1.18 Mb           0 b           0 b           610  
                                            aten::stack         0.15%     142.448ms         0.34%     324.806ms     184.339us       0.000us         0.00%       3.402ms       1.931us     151.96 Mb           0 b     274.00 Kb           0 b          1762  
                                              aten::cat         0.15%     142.005ms         0.16%     156.959ms      89.080us       3.291ms         0.00%       3.402ms       1.931us     151.96 Mb     151.96 Mb     274.00 Kb     274.00 Kb          1762  
                                            aten::empty         0.16%     158.658ms         0.16%     158.658ms       5.637us       0.000us         0.00%       0.000us       0.000us       1.80 Mb       1.80 Mb    1280.12 Gb    1280.12 Gb         28148  
                                                  train        38.88%       37.428s        60.72%       58.449s       58.449s       0.000us         0.00%       32.985s       32.985s       1.51 Mb    -136.51 Mb     864.94 Mb    -358.75 Gb             1  
                                         aten::randperm         0.00%       3.580ms         0.01%       7.231ms     602.583us       0.000us         0.00%       0.000us       0.000us       1.18 Mb         -48 b           0 b           0 b            12  
                                         aten::_to_copy         0.05%      43.374ms         0.30%     286.134ms      29.556us       0.000us         0.00%      88.782ms       9.171us     331.27 Kb      10.24 Kb     285.34 Mb           0 b          9681  
                                               aten::to         0.03%      32.954ms         0.32%     312.429ms      17.932us       0.000us         0.00%      88.454ms       5.077us     317.66 Kb      -9.15 Kb     285.34 Mb     596.00 Kb         17423  
                                    aten::empty_strided         0.11%     104.006ms         0.11%     104.006ms       4.235us       0.000us         0.00%       0.000us       0.000us     299.18 Kb     299.18 Kb     142.51 Gb     142.51 Gb         24558  
                                       aten::empty_like         0.02%      20.489ms         0.08%      72.654ms       7.636us       0.000us         0.00%       0.000us       0.000us      75.31 Kb      16.07 Kb     105.86 Gb       2.60 Gb          9515  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 96.263s
Self CUDA time total: 80.938s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                  train        38.88%       37.428s        60.72%       58.449s       58.449s       0.000us         0.00%       32.985s       32.985s       1.51 Mb    -136.51 Mb     864.94 Mb    -358.75 Gb             1  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.01%       6.176ms        25.89%       24.921s      45.477ms       0.000us         0.00%     682.435ms       1.245ms           0 b           0 b      46.30 Gb     -17.09 Gb           548  
                                     EmbeddingBackward0         0.00%       2.749ms        25.88%       24.915s      45.466ms       0.000us         0.00%     682.435ms       1.245ms           0 b           0 b      63.39 Gb           0 b           548  
                               aten::embedding_backward         0.00%       2.531ms        25.88%       24.913s      45.461ms       0.000us         0.00%     682.435ms       1.245ms           0 b           0 b      63.39 Gb           0 b           548  
                         aten::embedding_dense_backward         0.10%      99.845ms        25.88%       24.910s      45.456ms     237.003ms         0.29%     682.435ms       1.245ms           0 b           0 b      63.39 Gb     -38.53 Gb           548  
                                  cudaStreamSynchronize        25.78%       24.816s        25.78%       24.816s     301.916us     847.447ms         1.05%     847.447ms      10.310us           0 b           0 b           0 b           0 b         82194  
                                       aten::is_nonzero         0.25%     238.672ms        13.92%       13.396s     172.852us       0.000us         0.00%        1.561s      20.136us           0 b           0 b           0 b           0 b         77500  
                                             aten::item         0.16%     153.290ms        13.90%       13.378s     146.488us       0.000us         0.00%        1.777s      19.462us           0 b           0 b           0 b           0 b         91324  
                              aten::_local_scalar_dense         0.31%     302.870ms        13.80%       13.285s     145.476us      79.606ms         0.10%        1.820s      19.933us           0 b           0 b           0 b           0 b         91324  
                                        cudaMemcpyAsync        13.56%       13.058s        13.56%       13.058s     156.646us        1.035s         1.28%        1.035s      12.417us           0 b           0 b           0 b           0 b         83357  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 96.263s
Self CUDA time total: 80.938s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.16%     158.658ms         0.16%     158.658ms       5.637us       0.000us         0.00%       0.000us       0.000us       1.80 Mb       1.80 Mb    1280.12 Gb    1280.12 Gb         28148  
                                             aten::lstm         0.05%      51.994ms         5.29%        5.095s       8.393ms       0.000us         0.00%       29.859s      49.192ms           0 b           0 b     415.48 Gb           0 b           607  
                                       aten::_cudnn_rnn         2.43%        2.342s         5.22%        5.025s       8.278ms       22.880s        28.27%       29.857s      49.188ms           0 b           0 b     415.48 Gb    -224.99 Gb           607  
                                    aten::empty_strided         0.11%     104.006ms         0.11%     104.006ms       4.235us       0.000us         0.00%       0.000us       0.000us     299.18 Kb     299.18 Kb     142.51 Gb     142.51 Gb         24558  
                                            aten::zeros         0.02%      22.836ms         0.17%     161.094ms      35.775us       0.000us         0.00%     269.867ms      59.930us           0 b           0 b     140.01 Gb           0 b          4503  
                                       aten::empty_like         0.02%      20.489ms         0.08%      72.654ms       7.636us       0.000us         0.00%       0.000us       0.000us      75.31 Kb      16.07 Kb     105.86 Gb       2.60 Gb          9515  
                                       aten::contiguous         0.01%      11.377ms         0.11%     110.491ms      39.475us       0.000us         0.00%     255.745ms      91.370us           0 b           0 b     104.37 Gb      10.88 Gb          2799  
                                            aten::clone         0.01%      12.785ms         0.11%     105.657ms      37.748us       0.000us         0.00%     274.954ms      98.233us           0 b           0 b     104.37 Gb      -2.56 Gb          2799  
                                    aten::_foreach_sqrt         0.02%      20.373ms         0.06%      59.348ms     108.299us     197.840ms         0.24%     198.593ms     362.396us           0 b           0 b      70.90 Gb           0 b           548  
                                     aten::_foreach_add         0.03%      25.425ms         0.06%      60.651ms     110.677us     195.221ms         0.24%     292.188ms     533.190us           0 b           0 b      70.90 Gb           0 b           548  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 96.263s
Self CUDA time total: 80.938s

-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
autograd::engine::evaluate_function: CudnnRnnBackwar...         0.02%      15.905ms        10.37%        9.985s      18.220ms       0.000us         0.00%       76.505s     139.608ms           0 b           0 b    -438.43 Gb    -463.03 Gb           548  
                                      CudnnRnnBackward0         0.01%       8.174ms        10.36%        9.969s      18.191ms       0.000us         0.00%       76.505s     139.608ms           0 b           0 b      24.60 Gb    -546.88 Mb           548  
                              aten::_cudnn_rnn_backward         5.20%        5.005s        10.35%        9.961s      18.176ms       54.538s        67.38%       76.505s     139.608ms           0 b           0 b      25.13 Gb    -454.37 Gb           548  
                                                  train        38.88%       37.428s        60.72%       58.449s       58.449s       0.000us         0.00%       32.985s       32.985s       1.51 Mb    -136.51 Mb     864.94 Mb    -358.75 Gb             1  
                                             aten::lstm         0.05%      51.994ms         5.29%        5.095s       8.393ms       0.000us         0.00%       29.859s      49.192ms           0 b           0 b     415.48 Gb           0 b           607  
                                       aten::_cudnn_rnn         2.43%        2.342s         5.22%        5.025s       8.278ms       22.880s        28.27%       29.857s      49.188ms           0 b           0 b     415.48 Gb    -224.99 Gb           607  
                                       cudaLaunchKernel         8.39%        8.080s         8.39%        8.080s       4.284us       19.587s        24.20%       19.984s      10.595us           0 b           0 b           0 b           0 b       1886106  
                                  volta_sgemm_32x128_nt         0.00%       0.000us         0.00%       0.000us       0.000us       17.948s        22.18%       17.948s       5.459ms           0 b           0 b           0 b           0 b          3288  
                        volta_sgemm_128x32_sliced1x4_tn         0.00%       0.000us         0.00%       0.000us       0.000us       12.350s        15.26%       12.350s      39.936us           0 b           0 b           0 b           0 b        309248  
                        volta_sgemm_128x32_sliced1x4_nn         0.00%       0.000us         0.00%       0.000us       0.000us       11.881s        14.68%       11.881s      42.501us           0 b           0 b           0 b           0 b        279552  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 96.263s
Self CUDA time total: 80.938s